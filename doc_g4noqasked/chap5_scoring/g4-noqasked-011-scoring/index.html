<!doctype html><html data-bs-theme=light itemscope itemtype=http://schema.org/WebPage lang=ko><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=manifest href=https://evanote.mew.kr/manifest.webmanifest><meta name=description content="Geant4 무작정 따라하기 시리즈의 열한번째. Geant4에서 스코어링을 구현하는 방법에 대해 알아봅니다.
"><link rel=icon href=/favicon-16x16.png sizes=16x16 type=image/png><link rel=icon href=/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/favicon-150x150.png sizes=150x150 type=image/png><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=mask-icon href=/mask-icon.svg color=#000000><meta property="og:title" content="Geant4 무작정 따라하기 - 11. 스코어링 구현"><meta property="og:description" content="Geant4 무작정 따라하기 시리즈의 열한번째. Geant4에서 스코어링을 구현하는 방법에 대해 알아봅니다."><meta property="og:type" content="article"><meta property="og:url" content="https://evanote.mew.kr/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/"><meta property="og:image" content="https://evanote.mew.kr/"><meta property="article:section" content="doc_g4noqasked"><meta property="article:published_time" content="2021-08-18T14:11:10+09:00"><meta property="article:modified_time" content="2021-08-18T14:11:10+09:00"><meta itemprop=name content="Geant4 무작정 따라하기 - 11. 스코어링 구현"><meta itemprop=description content="Geant4 무작정 따라하기 시리즈의 열한번째. Geant4에서 스코어링을 구현하는 방법에 대해 알아봅니다."><meta itemprop=datePublished content="2021-08-18T14:11:10+09:00"><meta itemprop=dateModified content="2021-08-18T14:11:10+09:00"><meta itemprop=wordCount content="2340"><meta itemprop=image content="https://evanote.mew.kr/"><meta itemprop=keywords content="HowTo,Geant4,Scoring,MultiFunctionalDetector,PrimitiveScorer,Filter,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://evanote.mew.kr/"><meta name=twitter:title content="Geant4 무작정 따라하기 - 11. 스코어링 구현"><meta name=twitter:description content="Geant4 무작정 따라하기 시리즈의 열한번째. Geant4에서 스코어링을 구현하는 방법에 대해 알아봅니다."><title>Geant4 무작정 따라하기 - 11. 스코어링 구현 - 스코어링 - Geant4 무작정 따라하기 - EvaNOTE</title><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3621798796175855" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EENM61GFMT"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EENM61GFMT",{anonymize_ip:!1})}</script><link href="/css/hb.2a5ce189af9ff60967ef2ebbd35724251db06d22aabe2d842388d0343cd3c906.css" rel=stylesheet><script src=/js/init.b980cf5ff873691f491c400ab7f55079eb2d1eef456f2eec75db7cf3d8c9dcc7.js integrity="sha256-uYDPX/hzaR9JHEAKt/VQeestHu9Fby7sddt889jJ3Mc="></script></head><body><noscript><div class="alert alert-danger text-center rounded-0" role=alert><svg aria-hidden="true" class="bi bi-exclamation-square-fillbi bi-exclamation-square-fill hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2zm6 4c.535.0.954.462.9.995l-.35 3.507a.552.552.0 01-1.1.0L7.1 4.995A.905.905.0 018 4zm.002 6a1 1 0 110 2 1 1 0 010-2z"/></svg>사용하고 계신 브라우저가 JavaScript를 지원하지 않습니다.</div></noscript><header class=hb-header><nav class="hb-header-nav navbar navbar-expand-lg"><div class="hb-announcement-bar text-center px-1 py-2 w-100 overflow-hidden border-bottom border-secondary"><div class="hb-announcement text-truncate active">EvaNOTE가 대공사를 마쳤습니다!!</div></div><div class=container-fluid><button class="navbar-toggler border-0 shadow-none d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=.hb-docs-nav aria-expanded=false aria-label="Toggle docs navigation"><svg aria-hidden="true" class="bi bi-listbi bi-list hi-svg-inline" fill="currentcolor" height="1.25em" viewBox="0 0 16 16" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M2.5 12a.5.5.0 01.5-.5h10a.5.5.0 010 1H3a.5.5.0 01-.5-.5zm0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 8zm0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 4z"/></svg></button>
<a class="navbar-brand d-flex align-items-center" href=/><img src=https://evanote.mew.kr/images/logo_hu92b1688a25baf49e9be40db616e2b188_18319_0x64_resize_box_3.png alt=Logo width=64 height=64 class="hb-header-logo d-inline-block align-text-top me-2">EvaNOTE</a><div class="d-flex order-5"><div class="search-modal-toggle hb-header-search-form position-relative d-flex ms-lg-1"><button type=button class="hb-header-search-icon border-0 bg-transparent px-2" aria-label="Toggle search"><svg aria-hidden="true" class="bi bi-searchbi bi-search hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1.007 1.007.0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0z"/></svg></button>
<input class="form-control rounded-5 d-none d-lg-block ms-lg-1" placeholder=검색>
<span class="hb-header-search-keys position-absolute d-none d-lg-block"><kbd>CTRL</kbd>
<kbd>K</kbd></span></div><button class="navbar-toggler border-0 shadow-none" type=button data-bs-toggle=offcanvas data-bs-target=#hb-header-content aria-controls=hb-header-content aria-label="Toggle navigation"><svg aria-hidden="true" class="bi bi-three-dotsbi bi-three-dots hi-svg-inline" fill="currentcolor" height="1.25em" viewBox="0 0 16 16" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3zm5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3zm5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3z"/></svg></button></div><div class="offcanvas offcanvas-lg offcanvas-end" tabindex=-1 id=hb-header-content aria-labelledby=hb-header-content-label><div class=offcanvas-header><h5 class=offcanvas-title id=hb-header-content-label>EvaNOTE</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><ul class="hb-header-menus navbar-nav flex-row flex-wrap"><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto"><a class=nav-link id=header-menu-blog href role=button data-bs-toggle=dropdown data-bs-reference=#header-menu-blog-submenus aria-expanded=false><div class="nav-link-content d-flex align-items-center"><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" style="color:violet" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M192 32c0 17.7 14.3 32 32 32 123.7.0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1.0 224 0c-17.7.0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7.0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7.0-32 14.3-32 32zM96 144c0-26.5-21.5-48-48-48S0 117.5.0 144V368c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144H128v96h16c26.5.0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"/></svg>단편글<span class="dropdown-toggle-icon d-flex align-items-center ms-1"><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"/></svg></span></div></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby=header-menu-blog data-bs-popper=none><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/categories><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-folderbi bi-folder hi-svg-inline" fill="currentcolor" height="2em" style="color:orange" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M.54 3.87.5 3a2 2 0 012-2h3.672a2 2 0 011.414.586l.828.828A2 2 0 009.828 3h3.982a2 2 0 011.992 2.181l-.637 7A2 2 0 0113.174 14H2.826A2 2 0 01.835 12.181l-.637-7a1.99 1.99.0 01.342-1.31zM2.19 4a1 1 0 00-.996 1.09l.637 7a1 1 0 00.995.91h10.348a1 1 0 00.995-.91l.637-7A1 1 0 0013.81 4H2.19zm4.69-1.707A1 1 0 006.172 2H2.5a1 1 0 00-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">카테고리</div><p class="dropdown-item-desc mb-0 text-wrap">카테고리별 보기</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/tags><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-tagsbi bi-tags hi-svg-inline" fill="currentcolor" height="2em" style="color:green" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2v4.586l7 7L14.586 9l-7-7H3zM2 2a1 1 0 011-1h4.586a1 1 0 01.707.293l7 7a1 1 0 010 1.414l-4.586 4.586a1 1 0 01-1.414.0l-7-7A1 1 0 012 6.586V2z"/><path d="M5.5 5a.5.5.0 110-1 .5.5.0 010 1zm0 1a1.5 1.5.0 100-3 1.5 1.5.0 000 3zM1 7.086a1 1 0 00.293.707L8.75 15.25l-.043.043a1 1 0 01-1.414.0l-7-7A1 1 0 010 7.586V3a1 1 0 011-1v5.086z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">태그</div><p class="dropdown-item-desc mb-0 text-wrap">태그별 보기</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/archives><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-archivebi bi-archive hi-svg-inline" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1v7.5A2.5 2.5.0 0112.5 15h-9A2.5 2.5.0 011 12.5V5A1 1 0 010 4V2zm2 3v7.5A1.5 1.5.0 003.5 14h9a1.5 1.5.0 001.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5.0 01.5-.5h5a.5.5.0 010 1h-5A.5.5.0 015 7.5z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">ArXiv</div><p class="dropdown-item-desc mb-0 text-wrap">연도별 모아보기</p></div></a></li><li><hr class=dropdown-divider></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/post><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="2em" style="color:violet" viewBox="0 0 512 512" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M192 32c0 17.7 14.3 32 32 32 123.7.0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1.0 224 0c-17.7.0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7.0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7.0-32 14.3-32 32zM96 144c0-26.5-21.5-48-48-48S0 117.5.0 144V368c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144H128v96h16c26.5.0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"/></svg></div><div class=dropdown-item-content><div class=dropdown-item-title>모든 단편글</div></div></a></li></ul></li><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto"><a class=nav-link id=header-menu-series href role=button data-bs-toggle=dropdown data-bs-reference=#header-menu-series-submenus aria-expanded=false><div class="nav-link-content d-flex align-items-center"><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 448 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M96 0C43 0 0 43 0 96V416c0 53 43 96 96 96H384h32c17.7.0 32-14.3 32-32s-14.3-32-32-32V384c17.7.0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H384 96zm0 384H352v64H96c-17.7.0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16H336c8.8.0 16 7.2 16 16s-7.2 16-16 16H144c-8.8.0-16-7.2-16-16zm16 48H336c8.8.0 16 7.2 16 16s-7.2 16-16 16H144c-8.8.0-16-7.2-16-16s7.2-16 16-16z"/></svg>연재글<span class="dropdown-toggle-icon d-flex align-items-center ms-1"><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"/></svg></span></div></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby=header-menu-series data-bs-popper=none><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/doc_g4install/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-bookbi bi-book hi-svg-inline" fill="currentcolor" height="2em" style="color:#e24d0e" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5.0 000 2.5v11a.5.5.0 00.707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5.0 00.78.0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5.0 0016 13.5v-11a.5.5.0 00-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/></svg></div><div class=dropdown-item-content><div class=dropdown-item-title>Geant4 설치 가이드</div></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center active" href=https://evanote.mew.kr/doc_g4noqasked/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-bookbi bi-book hi-svg-inline" fill="currentcolor" height="2em" style="color:#e24d0e" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5.0 000 2.5v11a.5.5.0 00.707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5.0 00.78.0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5.0 0016 13.5v-11a.5.5.0 00-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/></svg></div><div class=dropdown-item-content><div class=dropdown-item-title>Geant4 무작정 따라하기</div></div></a></li><li><hr class=dropdown-divider></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://evanote.mew.kr/series><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="2em" viewBox="0 0 448 512" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M96 0C43 0 0 43 0 96V416c0 53 43 96 96 96H384h32c17.7.0 32-14.3 32-32s-14.3-32-32-32V384c17.7.0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H384 96zm0 384H352v64H96c-17.7.0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16H336c8.8.0 16 7.2 16 16s-7.2 16-16 16H144c-8.8.0-16-7.2-16-16zm16 48H336c8.8.0 16 7.2 16 16s-7.2 16-16 16H144c-8.8.0-16-7.2-16-16s7.2-16 16-16z"/></svg></div><div class=dropdown-item-content><div class=dropdown-item-title>모든 연재글</div></div></a></li></ul></li></ul><ul class="hb-header-panel navbar-nav flex-row flex-wrap"><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><hr class="d-lg-none my-2 text-body-50"></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href=https://github.com/evandde target=_blank rel="nofollow me" title=GitHub><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg><span class="hb-social-text d-lg-none ms-1">GitHub</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href=mailto:evandde@gmail.com target=_blank rel="nofollow me" title=Gmail><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Gmail</title><path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636.0 010 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"/></svg><span class="hb-social-text d-lg-none ms-1">Gmail</span></a></li><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><div class="vr d-none d-lg-flex h-100 mx-lg-2 text-body"></div><hr class="d-lg-none my-2 text-body-50"></li><li class="theme-toggle nav-item dropdown col-6 col-lg-auto d-flex flex-column justify-content-center"><a class="btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-start justify-content-lg-center align-items-center" href=# role=button data-bs-toggle=dropdown aria-expanded=false><svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1 theme-toggle-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></svg><span class="d-lg-none ms-1"></span></a><ul class="theme-toggle-menu dropdown-menu dropdown-menu-end"><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-value=auto>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></svg></span></button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-value=dark>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-moon-starsbi bi-moon-stars hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278zM4.858 1.311A7.269 7.269.0 001.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316.0 005.205-2.162c-.337.042-.68.063-1.029.063-4.61.0-8.343-3.714-8.343-8.29.0-1.167.242-2.278.681-3.286z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></svg></span></button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-value=light>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-brightness-highbi bi-brightness-high hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 110-6 3 3 0 010 6zm0 1a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></span></button></li></ul></li></ul></div></div></div></nav></header><div class="hb-main container-fluid"><div class=hb-docs><div class=hb-docs-sidebar tabindex=-1 data-bs-hide=focusout><div class="hb-docs-nav offcanvas-lg pe-lg-2 offcanvas-start" aria-labelledby=hb-docs-nav-label><div class="offcanvas-header border-bottom"><h5 class=offcanvas-title id=hb-docs-nav-label>문서 탐색</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close data-bs-target=.hb-docs-nav></button></div><div class="offcanvas-body flex-column text-body-secondary"><ul class="hb-docs-nav-links list-unstyled"><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap1_opening/>기본 지식</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-7e4064e61342ff69fac4d64518e02f00 aria-expanded=false aria-controls=collapse-7e4064e61342ff69fac4d64518e02f00><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2" id=collapse-7e4064e61342ff69fac4d64518e02f00><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap1_opening/p1_opening/>들어가며</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap1_opening/p2_clonetest/>템플릿 코드 실행하기</a></li></ul></li><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap2_geometry/>지오메트리</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-d87db2f536cd8f8e66c07a421283107e aria-expanded=false aria-controls=collapse-d87db2f536cd8f8e66c07a421283107e><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2" id=collapse-d87db2f536cd8f8e66c07a421283107e><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap2_geometry/g4-noqasked-002-detcon/>지오메트리 정의 기본이론</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap2_geometry/g4-noqasked-003-solid/>지오메트리 모양 만들기</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap2_geometry/g4-noqasked-004-material/>물질 정의 및 사용</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap2_geometry/g4-noqasked-005-clhepclasses/>위치, 회전을 정의하는 법</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap2_geometry/g4-noqasked-006-phyvol/>지오메트리 배치하기</a></li></ul></li><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap3_verbose/>Geant4 Verbose</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-21bf2d3849e3a9343c8b4f3bb76f89a1 aria-expanded=false aria-controls=collapse-21bf2d3849e3a9343c8b4f3bb76f89a1><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2" id=collapse-21bf2d3849e3a9343c8b4f3bb76f89a1><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap3_verbose/g4-noqasked-007-trkvb/>기본용어와 Tracking Verbose</a></li></ul></li><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap4_primgen/>선원항</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-be003eba36b94a0c3598d9ef95d2becf aria-expanded=false aria-controls=collapse-be003eba36b94a0c3598d9ef95d2becf><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2" id=collapse-be003eba36b94a0c3598d9ef95d2becf><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap4_primgen/g4-noqasked-008-prigen/>선원항을 정의하는 법</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap4_primgen/g4-noqasked-009-randtool/>난수 기반 선원항 정의하기</a></li></ul></li><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded active"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap5_scoring/>스코어링</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-1411e414e68b81148dd05fa648ca5f33 aria-expanded=true aria-controls=collapse-1411e414e68b81148dd05fa648ca5f33><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2 show" id=collapse-1411e414e68b81148dd05fa648ca5f33><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-010-scoringtheory/>스코어링 이론</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded active" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/>스코어링 구현하기</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-012-writingrslt1/>결과를 Histogram으로 기록하기</a></li><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-013-writingrslt2/>결과를 Ntuple로 기록하기</a></li></ul></li><li class=hb-docs-nav-links-group><div class="hb-docs-nav-heading d-flex align-items-center justify-content-between rounded"><a class="d-flex flex-grow-1 align-items-center" href=/doc_g4noqasked/chap6_closing/>마무리</a>
<button class="hb-docs-nav-toggle btn btn-link py-0 px-1 text-secondary d-flex align-items-center" type=button data-bs-toggle=collapse data-bs-target=#collapse-66ad07cfa6fc3e2fe9555bd4e3552dc6 aria-expanded=false aria-controls=collapse-66ad07cfa6fc3e2fe9555bd4e3552dc6><svg aria-hidden="true" class="bi bi-chevron-rightbi bi-chevron-right hi-svg-inline hb-docs-nav-toggle-icon" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></button></div><ul class="collapse list-unstyled fw-normal small ms-2" id=collapse-66ad07cfa6fc3e2fe9555bd4e3552dc6><li class=hb-docs-nav-links-span-all><a class="hb-docs-nav-link d-flex align-items-center rounded" href=/doc_g4noqasked/chap6_closing/g4-noqasked-014-closing/>마치며</a></li></ul></li></ul></div></div></div><div class=hb-docs-main><div class="hb-module container-fluid px-0"><nav aria-label=breadcrumb><ol class="hb-breadcrumb breadcrumb"><li class=breadcrumb-item><a href=/ title="EvaNOTE - 지식과 경험의 기록">홈</a></li><li class=breadcrumb-item><a href=/doc_g4noqasked/ title="Geant4 무작정 따라하기">Geant4 무작정 따라하기</a></li><li class=breadcrumb-item><a href=/doc_g4noqasked/chap5_scoring/ title=스코어링>스코어링</a></li><li class="breadcrumb-item active" aria-current=page><a href=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/ title="Geant4 무작정 따라하기 - 11. 스코어링 구현">Geant4 무작정 따라하기 - 11. 스코어링 구현</a></li></ol></nav></div><div class=hb-docs-doc><div class=hb-docs-doc-intro><h1 class=mb-3>Geant4 무작정 따라하기 - 11. 스코어링 구현</h1><div class="hb-blog-post-meta hb-docs-doc-meta mb-3"><span class=hb-docs-doc-date>2021년 8월 18일</span>
<span class=hb-blog-post-reading-time>읽는 데에 11분</span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href=/categories/geant4/>Geant4</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href=/series/geant4-%EB%AC%B4%EC%9E%91%EC%A0%95-%EB%94%B0%EB%9D%BC%ED%95%98%EA%B8%B0/>Geant4 무작정 따라하기</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/howto/>HowTo</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/geant4/>Geant4</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/scoring/>Scoring</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/multifunctionaldetector/>MultiFunctionalDetector</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/primitivescorer/>PrimitiveScorer</a></span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/filter/>Filter</a></span></div></div><div class="hb-docs-doc-toc ps-lg-3 text-body-secondary"><div class="h6 d-none d-md-block">목차</div><hr class="d-none d-md-block"><div class="d-grid d-block d-md-none mb-2"><button class="btn btn-light d-flex align-items-center justify-content-between collapsed" type=button data-bs-toggle=collapse data-bs-target=.hb-docs-doc-toc-collapse aria-expanded=false aria-controls=collapse-toc>
<span>목차</span><svg aria-hidden="true" class="bi bi-chevron-expandbi bi-chevron-expand hi-svg-inline ms-2" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708zm0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708z"/></svg></button></div><div class="px-2 px-md-0"><div id=collapse-toc class="collapse hb-docs-doc-toc-collapse"><nav id=TableOfContents><ul><li><a href=#sensitive-detector-설계>Sensitive Detector 설계</a><ul><li><a href=#mfd-만들고-추가하기>MFD 만들고 추가하기</a></li><li><a href=#ps-등록하기>PS 등록하기</a></li></ul></li><li><a href=#logical-volume에-sd-세팅>Logical Volume에 SD 세팅</a></li><li><a href=#중간-점검>중간 점검</a></li><li><a href=#event가-끝날-때-hit-확인>Event가 끝날 때 Hit 확인</a><ul><li><a href=#hitscollection의-id-가져오기>HitsCollection의 ID 가져오기</a></li><li><a href=#id를-이용하여-hc-꺼내기>ID를 이용하여 HC 꺼내기</a></li><li><a href=#hc에서-hit-꺼내기>HC에서 Hit 꺼내기</a></li><li><a href=#결과-확인>결과 확인</a></li></ul></li><li><a href=#최종-파일-다운받는-법>최종 파일 다운받는 법</a></li><li><a href=#정리>정리</a></li></ul></nav></div></div></div><div class=hb-docs-doc-main><div class="hb-docs-doc-content mb-5" data-bs-spy=scroll data-bs-target=#TableOfContents><p>Geant4 무작정 따라하기 시리즈의 열한번째. Geant4에서 스코어링을 구현하는 방법에 대해 알아봅니다.</p><p>지난 글에서 살펴본 스코어링 이론을 바탕으로, 이번 글에서는 스코어링을 직접 구현해보도록 하겠습니다.</p><p>스코어링을 구현하는 방법은 크게 다음의 3단계를 통해 진행됩니다.</p><ol><li>스코어링을 위한 Sensitive Detector 설계</li><li>관심 있는 지오메트리의 Logical Volume에 Sensitive Detector를 세팅</li><li>Event가 끝날 때 HCofThisEvent에서 Hit(관심 있는 물리량)을 꺼내어 확인</li></ol><p>차례차례 살펴보도록 합시다.</p><hr><h2 id=sensitive-detector-설계>Sensitive Detector 설계</h2><p>Sensitive Detector를 설계하는 방법은 지난 글에서 말씀드렸습니다. 이 시리즈에서는 Multi Functional Detector(MFD)에 사용자가 원하는 Primitive Scorer들을 Register하여 설계하는 방법만 다루겠다고 하였지요.</p><p>이 내용을 코드로 입력하는 곳도 정해져 있습니다. 바로 <b>DetectorConstruction.cc 파일</b>에 있는 <b>ConstructSDandField() 함수 내부</b>입니다. DetectorConstruction.cc 파일을 열어보시면, 대부분의 경우 맨 아래쪽 부근에 다음과 같은 함수가 있을 것입니다. 이 함수의 중괄호({}) 내부에 작성할 것입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/01_consdandfield_hud5d43139c37466f8384ee604e5938563_110949_1479x981_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/01_consdandfield.5c7653d3638e6626c7e8522bf66d0701.png alt=01_consdandfield loading=lazy height=981 width=1479></picture></p><p><font color=red>물론, 관련한 헤더는 당연히 DetectorConstruction.cc 파일의 맨 위에 포함시켜 주셔야 합니다. 여기서 필요한 헤더는 다음과 같습니다.</font></p><ul><li><font color=red>G4SDManager.hh</font></li><li><font color=red>G4MultiFunctionalDetector.hh</font></li><li><font color=red>사용한 PrimitiveScorer와 Filter의 헤더 (G4PSEnergyDeposit.hh 등)</font></li></ul><h3 id=mfd-만들고-추가하기>MFD 만들고 추가하기</h3><p>Multi Functional Detector를 만드는 과정은 딱 두 가지만 하시면 됩니다.</p><ol><li>G4MultiFunctionalDetector 클래스의 객체를 만든다.</li><li>해당 객체를 G4SDManager에 추가한다.</li></ol><p>코드로는 다음의 두 줄입니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>mfd</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4MultiFunctionalDetector</span><span class=p>(</span><span class=s>&#34;Detector&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>G4SDManager</span><span class=o>::</span><span class=n>GetSDMpointer</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>AddNewDetector</span><span class=p>(</span><span class=n>mfd</span><span class=p>);</span>
</span></span></code></pre></div><p>mfd라는 변수명으로 객체를 만들고, 이를 추가해주었습니다.</p><p>좀 더 자세히 살펴보도록 하죠.</p><h4 id=mfd-객체-만들기>MFD 객체 만들기</h4><p>Geant4에서는 Multi Functional Detector를 만들기 위해 이름 그대로 G4MultiFunctionalDetector라는 클래스를 제공하고 있습니다. 사용자는 이 클래스의 생성자를 이용하여 객체를 한 개 만들어주면 됩니다.</p><p>이 클래스의 생성자는 다음과 같습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=n>G4MultiFunctionalDetector</span><span class=p>(</span><span class=n>G4String</span> <span class=n>name</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>name: Multi Functional Detector의 이름. 자유롭게 적으면 됨. <b>나중에 쓰이는 값이므로 기억</b>해둘 것</li></ul><p>문자열 형태의 입력값 한 개만 자유롭게 넣어주면 됩니다. 입력 인자로 넣어준 <b>이 값은 MFD의 이름</b>이 되는데, 나중에 HCofThisEvent에서 사용되니 적절한 이름으로 잘 지어주세요. 위 예시 코드에서는 &ldquo;Detector"라는 이름을 지어주었습니다.</p><h4 id=mfd-추가하기>MFD 추가하기</h4><p>Geant4에서 Sensitive Detector를 사용하기 위해서는 <b>반드시 G4SDManager에 그 SD를 추가</b>해주어야 합니다. 그래야 Geant4가 입자를 수송하면서 SD 목록 중 조건에 부합하는 것들에 대해 스코어링을 수행해주기 때문입니다.</p><p>G4SDManager는 Geant4가 제공하는 것을 가져다 쓰면 되며, 이 클래스가 제공하는 <b>AddNewDetector()라는 함수를 통해 우리가 설계한 SD를 추가</b>하게 됩니다. 이 함수의 원형은 다음과 같습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=kt>void</span> <span class=nf>AddNewDetector</span><span class=p>(</span><span class=n>G4VSensitiveDetector</span> <span class=o>*</span><span class=n>aSD</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>aSD: 추가할 Sensitive Detector 객체의 포인터</li></ul><div class="alert alert-info d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-info-circle-fillbi bi-info-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194.0.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703.0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 110-2 1 1 0 010 2z"/></svg></div><div class=alert-content>C++적인 내용을 덧붙이자면, G4MultiFunctionalDetector 클래스는 G4VSensitiveDetector 클래스를 상속받아 만들어진 클래스입니다. 따라서, MFD 객체를 AddNewDetector의 인자로 사용할 수 있는 것입니다.</div></div><p>이 함수의 입력 인자로, 앞서 저희가 만들어둔 MFD 객체를 그대로 써주시면 됩니다.</p><h3 id=ps-등록하기>PS 등록하기</h3><p>이제 MFD는 만들었으니, 실제 스코어링 기능을 수행하는 Primitive Scorer를 등록해야 합니다. 이 내용도 <b>ConstructSDandField() 함수 내부</b>에 위에서 작성한 두 줄에 이어서 계속 써주시면 됩니다.</p><p>여기도 딱 두 가지만 해주시면 됩니다.</p><ol><li>원하는 Primitive Scorer 클래스의 객체를 만든다.</li><li>해당 PS 객체를 MFD에 등록한다.</li></ol><p>예를 들어 해당 지오메트리 내에 deposit된 에너지의 총합을 스코어링하는 G4PSEnergyDeposit을 등록하고 싶다면, 다음과 같이 두 줄을 작성하면 됩니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>psEDep</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4PSEnergyDeposit</span><span class=p>(</span><span class=s>&#34;EDep&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>mfd</span><span class=o>-&gt;</span><span class=n>RegisterPrimitive</span><span class=p>(</span><span class=n>psEDep</span><span class=p>);</span>
</span></span></code></pre></div><p>psEDep이라는 변수명으로 G4PSEnergyDeposit 클래스의 객체를 만들고, 이를 앞서 만들어둔 mfd 변수명으로 정의된 MFD 객체에 등록해주었습니다.</p><p>좀 더 자세히 살펴보겠습니다.</p><h4 id=ps-객체-만들기>PS 객체 만들기</h4><p>Primitive Scorer의 종류가 너무 많기 때문에, 이 글에서 모든 PS의 생성자를 살펴볼 수는 없습니다. 하지만 <b>모든 PS의 생성자에 있어 공통적으로 중요한 내용</b>이 있습니다. 대표적으로 G4PSEnergyDeposit 클래스의 생성자를 살펴봅시다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=n>G4PSEnergyDeposit</span><span class=p>(</span><span class=n>G4String</span> <span class=n>name</span><span class=p>,</span> <span class=n>G4int</span> <span class=n>depth</span><span class=o>=</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>G4PSEnergyDeposit</span><span class=p>(</span><span class=n>G4String</span> <span class=n>name</span><span class=p>,</span> <span class=k>const</span> <span class=n>G4String</span><span class=o>&amp;</span> <span class=n>unit</span><span class=p>,</span> <span class=n>G4int</span> <span class=n>depth</span><span class=o>=</span><span class=mi>0</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>name: Primitive Scorer의 이름. 자유롭게 적으면 됨. <b>나중에 쓰이는 값이므로 기억</b>해둘 것</li><li><i>depth:  <b>입력하지 않아도 되는 인자</b>.지오메트리의 관계(mother-daughter)에 따라, 상위 몇 번째 단계에 있는 지오메트리의 copy number를 참고할 것인지를 지정하는 인자. 기본값은 0</i></li><li><i>unit: <b>입력하지 않아도 되는 인자</b>. 스코어링 결과의 입출력시 사용할 단위. 기본값은 MeV</i></li></ul><p>MFD 객체를 만들 때와 마찬가지로, 문자열 형태의 입력값 한 개만 자유롭게 넣어주면 됩니다. 이 <b>입력 인자는 어느 PS를 사용하든 무조건 입력해주도록 되어있으며, 이 값이 해당 PS의 이름</b>이 됩니다.</p><p>이 또한 나중에 HCofThisEvent에서 사용되니 적절한 이름으로 잘 지어주세요. 위 예시 코드에서는 &ldquo;EDep"라는 이름을 지어주었습니다.</p><h4 id=mfd에-ps-등록하기>MFD에 PS 등록하기</h4><p>MFD에 PS를 등록할 때에는, G4MultiFunctionalDetector 클래스가 제공하는 <b>RegisterPrimitive() 함수를 이용</b>합니다. 이 함수의 원형은 다음과 같습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=n>G4bool</span> <span class=nf>RegisterPrimitive</span><span class=p>(</span><span class=n>G4VPrimitiveScorer</span> <span class=o>*</span><span class=n>aPS</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>aPS: 등록할 Primitive Scorer 객체의 포인터</li></ul><p>이 함수의 입력 인자로, 앞서 저희가 만들어둔 PS의 객체를 그대로 써주시면 됩니다.</p><h4 id=여러-개의-ps를-등록하는-법>여러 개의 PS를 등록하는 법</h4><p>하나의 MFD에 여러 개의 PS를 등록하는 방법도 간단합니다. 위에서 설명한 두 과정만 계속 반복해주시면 됩니다.</p><ol><li>원하는 Primitive Scorer 클래스의 객체를 만든다.</li><li>해당 PS 객체를 MFD에 등록한다.</li></ol><p>예를 들어 MFD를 만들고 G4PSEnergyDeposit과 G4PSDoseDeposit 두 개의 PS를 등록하는 경우를 코드로 작성한다면 다음과 같습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>mfd</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4MultiFunctionalDetector</span><span class=p>(</span><span class=s>&#34;Detector&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>G4SDManager</span><span class=o>::</span><span class=n>GetSDMpointer</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>AddNewDetector</span><span class=p>(</span><span class=n>mfd</span><span class=p>);</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=k>auto</span> <span class=n>psEDep</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4PSEnergyDeposit</span><span class=p>(</span><span class=s>&#34;EDep&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=n>mfd</span><span class=o>-&gt;</span><span class=n>RegisterPrimitive</span><span class=p>(</span><span class=n>psEDep</span><span class=p>);</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=k>auto</span> <span class=n>psDoseDep</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4PSDoseDeposit</span><span class=p>(</span><span class=s>&#34;DoseDep&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=n>mfd</span><span class=o>-&gt;</span><span class=n>RegisterPrimitive</span><span class=p>(</span><span class=n>psDoseDep</span><span class=p>);</span>
</span></span></code></pre></div><h4 id=filter-세팅하기>Filter 세팅하기</h4><p>Filter는 PS의 추가옵션 같은 기능입니다. Filter를 세팅하기 위해서는 PS를 등록할 때 Filter 관련 내용을 추가해야 합니다.</p><ol><li>원하는 Primitive Scorer 클래스의 객체를 만든다.</li><li><font color=red>원하는 Filter 클래스의 객체를 만든다.</font></li><li><font color=red>해당 Filter 객체를 PS에 세팅한다.</font></li><li>해당 PS 객체를 MFD에 등록한다.</li></ol><p>예를 들어, G4PSEnergyDeposit을 이용하는데, 전자(e-)가 deposit한 값만 스코어링하고 싶다면, 다음과 같이 작성하면 됩니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>psEDep</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4PSEnergyDeposit</span><span class=p>(</span><span class=s>&#34;EDep&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=k>auto</span> <span class=n>filterElectron</span> <span class=o>=</span> <span class=k>new</span> <span class=n>G4SDParticleFilter</span><span class=p>(</span><span class=s>&#34;e-Filter&#34;</span><span class=p>,</span> <span class=s>&#34;e-&#34;</span><span class=p>);</span> <span class=c1>// Create filter object
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=c1></span><span class=n>psEDep</span><span class=o>-&gt;</span><span class=n>SetFilter</span><span class=p>(</span><span class=n>filterElectron</span><span class=p>);</span> <span class=c1>// Set the filter to PS
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1></span><span class=n>mfd</span><span class=o>-&gt;</span><span class=n>RegisterPrimitive</span><span class=p>(</span><span class=n>psEDep</span><span class=p>);</span>
</span></span></code></pre></div><p>각 Filter마다 생성자의 형태나 사용방법은 상이하므로, 여기서 자세히 다루지는 않겠습니다.</p><hr><h2 id=logical-volume에-sd-세팅>Logical Volume에 SD 세팅</h2><p>이제 관심 있는 지오메트리의 Logical Volume에, 앞서 설계한 SD를 세팅해줄 차례입니다. 이 내용 또한 <b>ConstructSDandField() 함수 내부</b>에 작성하며, 아주 간단하게 한 줄이면 끝납니다. <b>SetSensitiveDetector() 함수</b>를 사용하면 됩니다.</p><p>예를 들어, <b>&ldquo;phantom"이라는 이름</b>을 가진 Logical Volume에 앞서 만든 <b>mfd</b> 변수명을 가진 SD를 세팅한다면, 다음과 같이 입력하면 됩니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=n>SetSensitiveDetector</span><span class=p>(</span><span class=s>&#34;phantom&#34;</span><span class=p>,</span> <span class=n>mfd</span><span class=p>);</span>
</span></span></code></pre></div><p>좀 더 자세히 살펴보도록 합시다. 이 함수의 원형은 다음과 같습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=kt>void</span> <span class=nf>SetSensitiveDetector</span><span class=p>(</span><span class=k>const</span> <span class=n>G4String</span><span class=o>&amp;</span> <span class=n>logVolName</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                          <span class=n>G4VSensitiveDetector</span><span class=o>*</span> <span class=n>aSD</span><span class=p>,</span> <span class=n>G4bool</span> <span class=n>multi</span> <span class=o>=</span> <span class=nb>false</span><span class=p>);</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=kt>void</span> <span class=nf>SetSensitiveDetector</span><span class=p>(</span><span class=n>G4LogicalVolume</span><span class=o>*</span> <span class=n>logVol</span><span class=p>,</span> <span class=n>G4VSensitiveDetector</span><span class=o>*</span> <span class=n>aSD</span><span class=p>);</span>
</span></span></code></pre></div><ul><li>logVolName: 관심 있는 지오메트리의 <b>Logical Volume의 이름</b></li><li>aSD: Sensitive Detector 객체의 포인터</li><li><i>multi: <b>입력하지 않아도 되는 인자</b>. logVolName 이름을 가진 지오메트리가 여러 개일 경우, 여러 개의 지오메트리 모두에 대해 SD를 세팅할지의 여부를 결정하는 인자. 기본값은 false</i></li><li>logVol: 관심 있는 지오메트리의 <b>Logical Volume 객체의 포인터</b></li></ul><p>SetSensitiveDetector 함수를 사용할 때, 관심 있는 지오메트리의 Logical Volume을 입력하는 방법이 두 가지입니다.</p><ol><li>Logical Volume의 이름을 입력</li><li>Logical Volume 객체의 포인터를 입력</li></ol><p>일단 이 시리즈에서 추천하는 바는 <b>그냥 Logical Volume의 이름을 입력하는 것</b>입니다. 제가 이전에 <a href=https://evandde.github.io/g4-noqasked-004-material/#logical-volume-%ec%a0%95%ec%9d%98%ed%95%98%ea%b8%b0 target=_blank rel="noopener noreferrer">Logical Volume을 정의하는 방법에 대해 적은 글</a>에서, <b>Logical Volume의 이름을 지을 때 다른 Logical Volume과 겹치지 않게끔 고유의 이름을 권장</b>한다고 하였습니다. 그 이유 중 하나가 이것입니다. 이름이 중복되면 그 중 어느 지오메트리에 SD를 세팅할 지가 불분명하기 때문입니다.</p><p>물론, 이름이 중복되는 모든 Logical Volume들에게 다 동일한 SD를 세팅하고자 한다면, 이 함수의 <i>multi</i> 인자 값을 true로 설정하여 사용할 수도 있습니다.</p><div class="alert alert-info d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-info-circle-fillbi bi-info-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194.0.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703.0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 110-2 1 1 0 010 2z"/></svg></div><div class=alert-content><p>이 시리즈에서는 지역변수나 변수의 범위(scope) 등을 설명하기에는 지면이 부족하여, 그냥 Logical Volume의 이름을 사용하는 방법만 설명합니다.</p><p>일반적으로 Logical Volume 객체는 Construct() 함수 내에 지역변수로 만들기 때문에, ConstructSDandField() 함수에서는 그 객체를 호출하지 못하기 때문이지요.</p><p>물론 객체를 불러오기 위한 몇 가지 방법들이 있습니다만 여기서는 생략하도록 하겠습니다.</p></div></div><hr><h2 id=중간-점검>중간 점검</h2><p>여기까지의 내용은 모두 <b>DetectorConstruction.cc 파일</b>에 있는 <b>ConstructSDandField() 함수 내부</b>에 작성하였습니다. 모두 마무리하셨다면, 일단 SD를 설계하고 이를 Logical Volume에 세팅하는 것까지 마친 상태입니다.</p><p>예를 들어 <b>G4PSEnergyDeposit 클래스를 이용하여 설계한 SD</b>를 <b>&ldquo;phantom"이라는 이름을 가진 Logical Volume에 세팅</b>한다면, 다음과 같이 코드가 작성되어야 합니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/02_consdandfield_complete_hudfe2e1998c310fd60c01f9222d12279a_10999_527x175_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/02_consdandfield_complete.337caa197352ff80809b48bd63adfa61.png alt=02_consdandfield_complete loading=lazy height=175 width=527></picture></p><p>여기서 중간 점검을 하는 이유는, <b><font color=red>다음 내용부터는 작성하는 파일이 달라지기 때문</font></b>입니다. 놓치지 말고 잘 따라오세요.</p><hr><h2 id=event가-끝날-때-hit-확인>Event가 끝날 때 Hit 확인</h2><p>이제 마지막 단계입니다. 앞서 두 단계를 통해 Geant4는 알아서 <b>매 Event마다 Hit을 생성하고 이를 HitsCollection에 담아 HCofThisEvent로 묶어서 가지고 있을 것</b>입니다. Event가 끝날 때 사용자가 이 Hit을 꺼내서 확인하지 않으면, 그 정보들은 그대로 사라집니다. 메모리를 날려버리고 새로운 다음 Event에 대한 정보를 기록하지요.</p><p>사용자가 할 일은 <b>Event가 끝날 때마다</b> Hit을 가져와서 확인하는 것입니다.</p><p>Geant4는 <b>매 Event마다 특정 행동을 반복적으로 수행하는 용도로 활용</b>할 수 있게끔 하기 위해, <b>EventAction</b>이라는 개념을 제공하고 있습니다. 이 시리즈에서는 <b>EventAction.cc라는 파일</b>을 열어서 이용하시면 됩니다. 여기에는 BeginOfEventAction()이라는 함수와 EndOfEventAction()이라는 함수가 있는데, 이름 그대로 매 Event가 시작되기 직전과 끝난 직후에 해당 함수가 실행되는 식으로 동작합니다. 즉, 우리처럼 <b>매 Event가 끝날 때마다 무언가를 하고 싶다면 EndOfEventAction() 함수 안에 할 일을 적으면 되는 것</b>이죠.</p><div class="alert alert-info d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-info-circle-fillbi bi-info-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194.0.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703.0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 110-2 1 1 0 010 2z"/></svg></div><div class=alert-content>엄밀히 말하면, G4UserEventAction 클래스를 상속 받아서 사용자만의 고유한 EventAction클래스를 만들고, 이 클래스의 함수 중 BeginOfEventAction() 함수나 EndOfEventAction() 함수를 overriding하여 작성하면 그 내용이 매 Event가 시작되기 직전과 끝난 직후에 각각 실행됩니다.</div></div><p>EventAction.cc 파일을 열어보시면 아래쪽에 <b>EndOfEventAction() 함수</b>가 있을 것입니다. 이 함수 안에 내용을 작성할 것입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_EOE_hub0f16bd98e7b7ed8780fe6e1639a4c13_78360_1479x981_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_EOE.cee552e89e898e0741539eb47519d09d.png alt=03_EOE loading=lazy height=981 width=1479></picture></p><p>이미 다음과 같은 내용이 작성되어 있네요.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>HCE</span> <span class=o>=</span> <span class=n>anEvent</span><span class=o>-&gt;</span><span class=n>GetHCofThisEvent</span><span class=p>();</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>HCE</span><span class=p>)</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>	<span class=k>return</span><span class=p>;</span>
</span></span></code></pre></div><p>의미는 그냥 써있는 그대로 읽으시면 됩니다. 한글로 쓰자면 다음과 같습니다.</p><ul><li>이번 Event에서 만들어진 HCofThisEvent를 가져와서 HCE라는 변수로 지정</li><li>만약 HCE가 유효하지 않다면<ul><li>EndOfEventAction() 함수를 종료</li></ul></li></ul><p><del>어때요, 참 쉽죠?</del></p><p>HCE 변수가 유효하지 않다면 if 조건문에 의해 함수가 종료되어 버리므로, <b>이 내용 아래 부분에 있는 내용은 반드시 HCE가 유효한 경우에만 실행될 것</b>입니다.</p><p>이제 HCofThisEvent로부터 Hit까지 가보도록 합시다.</p><h3 id=hitscollection의-id-가져오기>HitsCollection의 ID 가져오기</h3><p>HCofThisEvent는 HitsCollection들의 묶음이라고 하였습니다. 이 때 Geant4는 수많은 HC들을 쉽게 구분하기 위해 <b>HC마다 0 이상의 양의 정수값으로 된 고유의 ID번호를 부여</b>합니다. 다만, 사용자가 이 정수값을 직접 기억할 필요는 없습니다. 사용자는 <font color=red><b>HC의 이름</b></font>을 이용하여 이 ID번호를 찾아올 수 있기 때문입니다.</p><p>여기서 HC의 이름은 <b>Sensitive Detector를 설계할 때 결정</b>됩니다. 우리가 했던 것처럼 MFD와 PS를 이용할 경우에는, HC의 이름이 <code>{MFD의 이름}/{PS의 이름}</code>으로 결정됩니다. (대소문자 구분)</p><p>이 글에서 예시로 든 것처럼 다음과 같이 SD를 설계하였다면, <b><font color=red>HC의 이름은 &ldquo;Detector/EDep&rdquo;</font></b>이 되는 것입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/02_consdandfield_complete_hudfe2e1998c310fd60c01f9222d12279a_10999_527x175_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/02_consdandfield_complete.337caa197352ff80809b48bd63adfa61.png alt=02_consdandfield_complete loading=lazy height=175 width=527></picture></p><p>사용자는 이 HC의 이름만 있으면, G4SDManager로부터 GetCollectionID() 함수를 이용해 해당 HC의 고유 ID번호를 가져올 수 있습니다.</p><div class="alert alert-warning d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-exclamation-circle-fillbi bi-exclamation-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8 4a.905.905.0 00-.9.995l.35 3.507a.552.552.0 001.1.0l.35-3.507A.905.905.0 008 4zm.002 6a1 1 0 100 2 1 1 0 000-2z"/></svg></div><div class=alert-content><p>이 부분은 약간 C++ 측면의 깊은 설명이 필요합니다.</p><p>먼저 아무도 사용하지 않는 원초적인 방법부터 보여드리겠습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=n>G4int</span> <span class=n>fHCID</span> <span class=o>=</span> <span class=n>G4SDManager</span><span class=o>::</span><span class=n>GetSDMpointer</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>GetCollectionID</span><span class=p>(</span><span class=s>&#34;Detector/EDep&#34;</span><span class=p>);</span>
</span></span></code></pre></div><p>이렇게하면 <code>fHCID</code>라는 변수에 "Detector/EDep"이라는 HC의 고유 ID번호가 저장됩니다. <b>하지만, Geant4에서는 아무도 이렇게 사용하지 않습니다.</b></p></div></div><p><b>GetCollectionID() 함수는 시간을 많이 잡아먹는 느린 함수</b>입니다. 이런 함수를 매 Event가 종료될 때마다 실행하도록 하면 그만큼 시뮬레이션에 소요되는 시간이 길어지겠지요. 이런 문제를 해결하고자, <b>맨 처음에만 HC의 ID를 찾아오고</b> 그 이후에는 전에 <b>찾아온 값을 재활용</b>하기 위해 다음과 같이 코드를 작성하여 이용합니다.</p><ol><li><p><font color=red><b>include/EventAction.hh 파일</b></font>을 열고, G4int 자료형의 fHCID라는 이름의 멤버변수를 만듭니다.</p><p>멤버변수가 뭔지, 왜 hh파일이라는 곳에 쓰는지 잘 모르셔도 상관없습니다. 나중에 C++의 클래스 개념을 조금만 공부하시면 금방 이해될 것입니다.</p><p><b>일단 include 폴더에 있는 EventAction.hh 파일을 열어봅니다.</b></p><p>그리고 다음 그림과 같이 <code>private:</code>라고 쓰여있는 줄과 <code>};</code>가 적혀있는 줄 사이에, <code>G4int fHCID;</code>라고 적어서 G4int 자료형의 fHCID 멤버변수를 선언합니다.</p><p>(이미 만들어져 있다면 그냥 두시면 됩니다. 강의자료 제작 과정에서 혼선이 있었던 관계로, 이미 적혀있는 코드를 받으셨을 수도 있습니다)</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_1_EOE_Header_hu456fd6bb5b681706e7d917ab722d3d74_16660_604x447_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_1_EOE_Header.6df4c4322ca4b6bab649bd079cead94c.png alt=03_1_EOE_Header loading=lazy height=447 width=604></picture></p></li><li><p><font color=red><b>다시 src/EventAction.cc 파일로 돌아옵니다.</b></font></p><p>헤더를 포함시키는 부분(<code>#include ...</code>) 바로 밑에 보면, EventAction 클래스의 생성자가 있을 것입니다. <code>EventAction::EventAction() ...</code>과 같이 적혀있는 부분입니다.</p><p>여기에 다음 그림과 같이 <code>, fHCID(-1)</code>이라는 문구를 추가해줍니다.</p><p>이는 <b>fHCID라는 멤버변수를 -1로 초기화하겠다는 의미</b>입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_2_EOE_SourceInit_hu6cbf0e1cf314b2890451a75045bd2a43_16477_564x507_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_2_EOE_SourceInit.55f75503d78b9b0834a0535b8a0543c2.png alt=03_2_EOE_SourceInit loading=lazy height=507 width=564></picture></p></li><li><p><b>EventAction.cc 파일의 맨 위에 G4SDManager.hh 헤더를 포함</b>시킵니다.</p><p>이는 G4SDManager 클래스의 GetCollectionID 함수를 사용하기 위함입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_3_EOE_SourceInclude_hu04d38b5b4c71e8b7b7ffa8e8660f542e_17259_567x530_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_3_EOE_SourceInclude.c859e72202a1622b1769edf0327cd996.png alt=03_3_EOE_SourceInclude loading=lazy height=530 width=567></picture></p></li><li><p>마지막으로 EndOfEventAction 함수에 다음 두 줄의 코드를 작성합니다.</p><p>이렇게 하면 fHCID의 값이 -1일 때만(맨 처음) GetCollectionID 함수를 이용하여 fHCID를 적절한 HC의 ID로 설정하게 되고, 이후에는 fHCID에 -1이 아닌 다른 값이 들어있으므로 더이상 if문 내부가 실행되지 않습니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>if</span><span class=p>(</span><span class=n>fHCID</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>	<span class=n>fHCID</span> <span class=o>=</span> <span class=n>G4SDManager</span><span class=o>::</span><span class=n>GetSDMpointer</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>GetCollectionID</span><span class=p>(</span><span class=s>&#34;Detector/EDep&#34;</span><span class=p>);</span>
</span></span></code></pre></div><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_4_EOE_fHCIDsetting_hu5b4c945e05198daec0fb9f33f07823de_23338_745x596_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_4_EOE_fHCIDsetting.4cd2e42035a1b45bd12c9d0d723e97a4.png alt=03_4_EOE_fHCIDsetting loading=lazy height=596 width=745></picture></p></li></ol><h3 id=id를-이용하여-hc-꺼내기>ID를 이용하여 HC 꺼내기</h3><p>이어서, 이 ID를 이용하여 HCofThisEvent로부터 HC를 꺼내옵니다.</p><p>EventAction.cc 파일의 맨 위에 <b>G4THitsMap.hh 헤더를 포함</b>시켜 주시고, <b>EndOfEventAction 함수 안쪽에 다음의 한 줄</b>만 써주시면 됩니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>hitsMap</span> <span class=o>=</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=n>G4THitsMap</span><span class=o>&lt;</span><span class=n>G4double</span><span class=o>&gt;</span> <span class=o>*&gt;</span><span class=p>(</span><span class=n>HCE</span><span class=o>-&gt;</span><span class=n>GetHC</span><span class=p>(</span><span class=n>fHCID</span><span class=p>));</span>
</span></span></code></pre></div><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_5_EOE_HitsMap_hu03347962c5d2d3387ccdd360427b085b_27668_761x662_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/03_5_EOE_HitsMap.506d67901482f7d4eaaa7becb110399b.png alt=03_5_EOE_HitsMap loading=lazy height=662 width=761></picture></p><p>이상한 문구가 너무 많이 있어서 생소하실 수 있겠지만, 해석해보면 간단합니다.</p><ul><li><p>HCE->GetHC(fHCID)</p><p>HCE(HCofThisEvent)로부터 fHCID라는 ID를 가진 HC를 가져옴</p></li><li><p>static_cast&lt;G4THitsMap<g4double> *>(HCE->GetHC(fHCID))</p><p>앞서 가져온 HC를 <code>G4THitsMap&lt;G4double> *</code> 자료형으로 형변환함</p></li><li><p>auto hitsMap = static_cast&lt;G4THitsMap<g4double> *>(HCE->GetHC(fHCID));</p><p>이걸 hitsMap이라는 변수명으로 저장</p></li></ul><p>이제 모르는 내용은 <code>G4THitsMap&lt;G4double> *</code>이라는 처음보는 자료형 뿐이군요. 이는 HitsCollection의 종류 중 하나입니다. <a href=https://evandde.github.io/g4-noqasked-010-scoringtheory/#ps-hit-hc%ec%97%90-%eb%8c%80%ed%95%9c-%ec%83%81%ec%84%b8-%ec%84%a4%eb%aa%85 target=_blank rel="noopener noreferrer">이전 글</a>에서 Hit을 저장하는 방법이 여러가지가 있지만, PS를 이용하는 경우에는 <b>값을 누적</b>하여 <b><font color=blue>하나의 값</font></b>으로 저장하며, 이를 <b><font color=red>Copy Number라는 사물함 번호로 분류</font></b>하여 저장한다고 했었지요.</p><p>C++에서 이처럼 사물함 번호마다 값을 분류하여 저장하는 데이터 저장 방식의 대표적인 예로 <b>Map</b>이 있습니다. 그래서 Geant4에서는 이 Map이라는 구조를 활용하여 Hit을 저장하기 위한 Map이라는 이름으로 G4THitsMap이라는 클래스를 사용하고 있으며, 그 Map에 저장될 데이터가 G4double(실수)형이라는 것을 명시하기 위해 <code>G4THitsMap&lt;G4double></code>과 같이 작성하게 됩니다. 끝의 <code>*</code>는 이 자료형의 포인터형이라는 뜻입니다.</p><p><u>이 설명을 잘 모르겠으면 그냥 넘어가시고, 나중에 C++ 공부를 좀 더 한 뒤에 이해하셔도 됩니다.</u> 핵심은 다음의 두 가지입니다. 이거만 기억하셔도 충분합니다.</p><ol><li><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>auto</span> <span class=n>hitsMap</span> <span class=o>=</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=n>G4THitsMap</span><span class=o>&lt;</span><span class=n>G4double</span><span class=o>&gt;</span> <span class=o>*&gt;</span><span class=p>(</span><span class=n>HCE</span><span class=o>-&gt;</span><span class=n>GetHC</span><span class=p>(</span><span class=n>fHCID</span><span class=p>));</span>
</span></span></code></pre></div><p>라고 쓰면, hitsMap이라는 변수명으로 HitsCollection을 가져올 수 있음</p></li><li><p>이 hitsMap에는 <b><font color=red>Copy Number라는 사물함 번호</font></b>마다, <b><font color=blue>PS가 누적해서 기록한 값</font></b>이 저장되어 있음</p></li></ol><h3 id=hc에서-hit-꺼내기>HC에서 Hit 꺼내기</h3><p>앞서 가져온 HitsCollection에는 PS가 기록한 값이 Copy Number라는 번호로 분류된 사물함마다 저장되어 있을 것입니다.</p><p>어떤 사용자는 Sensitive Detector를 딱 하나의 지오메트리에만 달았을 수도 있고, 어떤 사용자는 여러 개의 지오메트리에 달았을 수도 있습니다. 게다가, 이 Event에서 입자들이 그 지오메트리들을 아예 안지나갔을 수도 있고(Hit이 0개), 모두 다 지나갔을 수도 있습니다.</p><p>이런 이유때문에, PS를 이용하여 설계한 SD를 이용한 경우에는 <b>HitsCollection 안에 몇 개의 Hit이 들어있을지 아무도 모릅니다</b>. 이런 모든 경우를 다 아우르기 위해, <b>HC안에 들어있는 Hit을 모두 다 훑으며 확인하는 방식을 이용</b>합니다. 이는 C++에서 제공하는 for-each 반복문을 사용하면 쉽게 해결됩니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>for</span> <span class=p>(</span><span class=k>const</span> <span class=k>auto</span> <span class=o>&amp;</span><span class=nl>iter</span> <span class=p>:</span> <span class=o>*</span><span class=p>(</span><span class=n>hitsMap</span><span class=o>-&gt;</span><span class=n>GetMap</span><span class=p>()))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p>위와 같이 작성하면, hitsMap 안에 있는 <b>모든 사물함</b>들을 <b>iter</b>라는 변수명으로 접근할 수 있게 됩니다. 이 때 <code>iter.first</code>는 <b><font color=red>사물함 번호</font></b>가 되고, <code>*(iter.second)</code>는 <b><font color=blue>그 사물함 안에 들어있는 hit의 누적 값</font></b>이 됩니다.</p><p>예를 들어, G4PSEnergyDeposit을 통해 기록된 deposit된 에너지의 총합을 살펴보고, 이 값이 0보다 큰 경우 터미널 화면에 출력하고자 한다면 다음과 같이 코드를 작성합니다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=k>for</span> <span class=p>(</span><span class=k>const</span> <span class=k>auto</span> <span class=o>&amp;</span><span class=nl>iter</span> <span class=p>:</span> <span class=o>*</span><span class=p>(</span><span class=n>hitsMap</span><span class=o>-&gt;</span><span class=n>GetMap</span><span class=p>()))</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=k>auto</span> <span class=n>eDep</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>iter</span><span class=p>.</span><span class=n>second</span><span class=p>);</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>eDep</span> <span class=o>&gt;</span> <span class=mf>0.</span><span class=p>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    	<span class=n>G4cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;--- Energy Deposit:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>eDep</span> <span class=o>/</span> <span class=n>MeV</span> <span class=o>&lt;&lt;</span> <span class=n>G4endl</span><span class=p>;</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class="alert alert-info d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-info-circle-fillbi bi-info-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 16A8 8 0 108 0a8 8 0 000 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194.0.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703.0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 110-2 1 1 0 010 2z"/></svg></div><div class=alert-content><code>G4cout</code>과 <code>G4endl</code>은 각각 <code>std::cout</code>과 <code>std::endl</code>과 동일하다고 생각하셔도 무방합니다.</div></div><div class="alert alert-warning d-flex" role=alert><div class=flex-shrink-0><svg aria-hidden="true" class="bi bi-exclamation-circle-fillbi bi-exclamation-circle-fill hi-svg-inline alert-icon me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8 4a.905.905.0 00-.9.995l.35 3.507a.552.552.0 001.1.0l.35-3.507A.905.905.0 008 4zm.002 6a1 1 0 100 2 1 1 0 000-2z"/></svg></div><div class=alert-content><p>아마 이렇게만 쓰시면 분명 <code>MeV</code>라는게 무엇인지 모르겠다며 에러가 뜰 것입니다!</p><p>앞서 지오메트리 파트에서 <b>단위</b>를 사용하려면 <b>G4SystemOfUnits.hh</b>라는 헤더가 필요하다고 했었죠?</p><p>여기서도 <code>MeV</code>를 사용해야 하므로, EventAction.cc 파일의 맨 위에 <code>#include "G4SystemOfUnits.hh"</code>라는 내용을 추가해주셔야 합니다.</p></div></div><p>위의 코드를 해석하자면 다음과 같이 되겠군요</p><ul><li>hitsMap에 있는 사물함 각각을 iter라는 변수로 지정하여 반복문을 수행<ul><li>사물함 안에 있는 값(<code>*(iter.second)</code>)을 eDep이라는 변수명으로 저장</li><li>만약 eDep의 값이 0보다 크다면<ul><li>화면에 &ldquo;&mdash; Energy Deposit: &ldquo;과 &ldquo;eDep 값을 MeV로 나눈 값"을 이어서 출력하고 줄바꿈</li></ul></li></ul></li></ul><p>이런 방법을 통해 PS가 저장한 값을 Event가 끝날 때 가져와서 확인할 수 있게 됩니다. 지금까지 수행한 내용을 모두 작성하면 EndOfEventAction 함수 내부는 다음과 같은 모습일 것입니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/04_EOE_complete_hu07471f2f3de2bed73ed399c2fc9bd200_18600_716x443_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/04_EOE_complete.74a7ce5616a37a14c8b263df1a8a29a1.png alt=04_EOE_complete loading=lazy height=443 width=716></picture></p><h3 id=결과-확인>결과 확인</h3><p>이렇게 작성하였을 때 출력되는 결과를 살펴보겠습니다. 개수가 너무 적으면 확률상 원하는 결과가 나오지 않을수도 있으니, run.mac 파일에서 <code>/run/beamOn 100</code>이라고 되어있는 줄을 <code>/run/beamOn 1000</code>과 같이 약간 늘려주세요.</p><p>build 디렉토리에 들어와서, 다음 명령어를 통해 tracking verbose 1단계와 함께 출력해서 살펴봅시다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>make
</span></span><span class=line><span class=ln>2</span><span class=cl>./g4_minimal run.mac &gt; vb.out
</span></span></code></pre></div><p>입자가 phantom에 들어가지 않은 다음과 같은 경우에는 추가적인 출력이 없는 것을 확인할 수 있습니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/05_EOE_rslt1_hube3480bcdce8df8ce362d378679da3fb_29968_934x530_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/05_EOE_rslt1.3e6e8b90165ba177ebd08c05e583569d.png alt=05_EOE_rslt1 loading=lazy height=530 width=934></picture></p><p>이제 phantom이라는 문구를 검색해 보겠습니다.</p><p>다음과 같이 phantom을 지나가긴 했지만, 별다른 반응이 일어나지 않아 deposit된 에너지가 없는 경우(<code>eDep > 0.</code> 조건을 만족하지 못함)에도 추가적인 출력이 없는 것을 확인할 수 있습니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/06_EOE_rslt2_hu3df22452996cf15d77a3335f68242939_23642_934x376_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/06_EOE_rslt2.d7aa3bd0481ddb4a42068e456c177e1c.png alt=06_EOE_rslt2 loading=lazy height=376 width=934></picture></p><p>좀 더 찾다보면 다음처럼 phantom에서 반응이 일어난 경우도 찾을 수 있습니다.</p><p>노란색으로 표시한 각 반응에서의 dE(MeV)들을 한 Event 내에서 다 합쳐져서, 그 총 합 값이 Event가 끝난 뒤에 <code>--- Energy Deposit:...</code>와 같이 출력되고 있음을 확인할 수 있습니다.</p><p><picture><source srcset=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/07_EOE_rslt3_hue3bba3d51fea93728d22ba41ad66cd1b_39083_935x601_resize_q75_h2_box_3.webp type=image/webp><img class=img-fluid src=/doc_g4noqasked/chap5_scoring/g4-noqasked-011-scoring/07_EOE_rslt3.539059787da89ed4f6ae6135e849a0db.png alt=07_EOE_rslt3 loading=lazy height=601 width=935></picture></p><hr><h2 id=최종-파일-다운받는-법>최종 파일 다운받는 법</h2><p>이번 글에서 작성한 코드는 <a href=https://github.com/evandde/g4_minimal/archive/c34d4e9e75b7e2d44ac72317927c81181a74bde4.zip target=_blank rel="noopener noreferrer">이 링크</a>를 통해 다운받을 수 있습니다.</p><p>혹은 git repository를 clone하신 분의 경우에는, example branch의 이전 커밋 중 V3 scoring이라는 커밋을 참고하셔도 됩니다.</p><hr><h2 id=정리>정리</h2><p>스코어링이 사실 쉽지 않습니다. 저도 많은 분들에게 강의를 수 차례 해보았지만, 제일 어려워하시는 부분이 스코어링입니다. C++의 문법을 모르면 생소한 코드가 너무 많아서 더욱 어려워보이는 것 같기도 합니다.</p><p>어떻게 하면 더 쉽게 전달할 수 있을까 많이 고민해 보았습니다만, 아직도 쉬워보이지는 않네요<svg aria-hidden="true" class="hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M464 256A208 208 0 1048 256a208 208 0 10416 0zM0 256a256 256 0 11512 0A256 256 0 110 256zM174.6 384.1c-4.5 12.5-18.2 18.9-30.7 14.4s-18.9-18.2-14.4-30.7C146.9 319.4 198.9 288 256 288s109.1 31.4 126.6 79.9c4.5 12.5-2 26.2-14.4 30.7s-26.2-2-30.7-14.4C328.2 358.5 297.2 336 256 336s-72.2 22.5-81.4 48.1zM144.4 208a32 32 0 1164 0 32 32 0 11-64 0zm192-32a32 32 0 110 64 32 32 0 110-64z"/></svg></p><p>하지만 스코어링 이론을 잘 숙지하고 있으시다면, 몇 번만 직접 구현해서 활용해보면 금방 터득하실 수 있으리라 생각합니다.</p><p>이제 다음 내용이 이 시리즈의 마지막입니다. 다음 글부터는 스코어링 결과를 파일로 출력하는 법에 대해 알아보겠습니다.</p></div><div class="hb-content-panel-wrapper position-sticky hb-module d-flex justify-content-center"><div class="hb-content-panel d-flex shadow w-auto rounded-5 bg-body"><div class=hb-content-panel-item><a href=#content-comments class="btn btn-link text-body" title=댓글 role=button><svg aria-hidden="true" class="bi bi-chat-dotsbi bi-chat-dots hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5 8A1 1 0 113 8a1 1 0 012 0zm4 0A1 1 0 117 8a1 1 0 012 0zm3 1a1 1 0 100-2 1 1 0 000 2z"/><path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06.0 008 15c4.418.0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437.0 01-.524 2.318l-.003.011a10.722 10.722.0 01-.244.637c-.079.186.074.394.273.362a21.673 21.673.0 00.693-.125zm.8-3.108a1 1 0 00-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06.0 01-2.088-.272 1 1 0 00-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97.0 00.398-2z"/></svg></a></div></div></div><ul class="hb-docs-doc-nav nav hb-module justify-content-between"><li class="nav-item my-1"><a class="nav-link p-0 d-flex align-items-center" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-010-scoringtheory/><svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline me-2" fill="currentcolor" height="1.5em" viewBox="0 0 16 16" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8zm15 0A8 8 0 110 8a8 8 0 0116 0zm-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5H11.5z"/></svg>스코어링 이론</a></li><li class="nav-item my-1"><a class="nav-link p-0 d-flex align-items-center" href=/doc_g4noqasked/chap5_scoring/g4-noqasked-012-writingrslt1/>결과를 Histogram으로 기록하기<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline ms-2" fill="currentcolor" height="1.5em" viewBox="0 0 16 16" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8zm15 0A8 8 0 110 8a8 8 0 0116 0zM4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5H4.5z"/></svg></a></li></ul><div id=content-comments class=hb-docs-doc-comments><div class=giscus></div></div></div></div></div></div></div><footer class="hb-footer pt-4 pt-md-5 pb-2 pb-md-3 bg-body-tertiary"><div class="container-fluid container-lg px-4 px-md-3 text-body-secondary"><div class=row><div class="hb-footer-site-info col mb-2 text-center"><div class=h5>EvaNOTE</div><ul class="list-unstyled small mb-2"><li class=mt-2>지식과 경험의 기록</li><li class=mt-2>Copyright © 2020-2023 Evan Kim. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank rel="noopener noreferrer">CC BY NC ND 4.0</a>.</li><li class=mt-2>Built with ❤️ from <a href=https://gohugo.io/ target=_blank rel=external title=Hugo>Hugo</a>, <a href=https://hugomods.com/ target=_blank rel=external title="Hugo Modules">Hugo Modules</a> and <a href=https://hbstack.dev/ target=_blank rel=external title="HB Framework">HB Framework</a>.</li></ul><div class="hb-footer-socials d-flex mb-2 justify-content-center"><a class="hb-social p-2" href=https://github.com/evandde target=_blank rel="nofollow me" title=GitHub><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="hb-social p-2" href=mailto:evandde@gmail.com target=_blank rel="nofollow me" title=Gmail><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Gmail</title><path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636.0 010 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"/></svg></a></div></div></div></div></footer><script src=/js/hb.2e1007890235750d5d497c09a35f5a3a6dc45fc9bec45c63b44ef0b2a3062722.js integrity="sha256-LhAHiQI1dQ1dSXwJo19aOm3EX8m+xFxjtE7wsqMGJyI=" defer></script>
<script src=https://giscus.app/client.js data-repo=evandde/blog_comment data-repo-id="MDEwOlJlcG9zaXRvcnkzMTIxOTcyMjI=" data-category=Announcements data-category-id=DIC_kwDOEpvAZs4CR8XO data-mapping=pathname data-reactions-enabled=1 data-input-position=top data-theme=preferred_color_scheme data-lang data-loading=lazy data-strict=1 crossorigin=anonymous onload='document.body.dispatchEvent(new Event("giscus-load"))' async></script>
<script>"serviceWorker"in navigator&&window.addEventListener("DOMContentLoaded",function(){navigator.serviceWorker.register("/sw.js")})</script><script src=/js/search.b4e01b348a37185d7ee4730c30392ce6a7f24f8ac98fe3cc52407c85434543b0.js defer></script></body></html>